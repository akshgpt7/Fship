# Fship

This project has as its backend a graph database, __Neo4J__ and __Django Framework__. 

To get started with setting up __Neo4J__ on your Desktop:
* Make sure you have Java installed on your Machine and that the _JAVA_HOME_ path is set.
* Download Neo4J from [here](https://neo4j.com/download/) and install it on your local machine.

However, if you don't want to download Neo4j locally on your machine, you can create an account for the Neo4j Sandbox, which is more of a free online Neo4J Database instance for about 10 Days. There will be no difference in how we utilise the Desktop version from how one may use the SandBox for our project. You can get started with the Sandbox [here](https://neo4j.com/sandbox/).

Now that you have __Neo4J__ set up, our project uses the official Neo4J Driver to communicate for communication between Neo4J and the Django project over the [Bolt protocol](https://en.wikipedia.org/wiki/Bolt_(network_protocol)). To install the driver, ensure you first have python and pip installed, then run:

```
pip install neo4j
```

Now that you have your environment set up, open your Neo4J Application (if desktop) and follow [these](https://neo4j.com/developer/neo4j-desktop/) instructions to create a new database. If you are using the sandbox account, this is a good [blog](https://neo4j.com/blog/graphcast-neo4j-sandbox-quick-start-guide/) to help you get started. You will be asked to create a username and a password. Make sure you remember these as they will be very useful when connecting the Django project to the Neo4J database over the Neo4J Driver.

Once you have a new database created, start it and open the Neo4J browser (as instructions in the previous paragraph have shown you).

The following __cypher__ queries can help you get started:
Create User
```
CREATE (u:User{name:"John Smith",email:"johnsmith@gmail.com",github:"https://github.com/JohnSmith"}) RETURN u
``` 
If all goes well, the above query should return a node. 

Now, to get the user id, which will be essential for the rest of the queries, do the following:
```
MATCH (u:User) RETURN id(u)
``` 
Notice that the id here is an id generated by Neo4J. The following queries depend on it. Let's call it _userID_. Any occurence of _userID_ in the following queries ought to be replaced by the exact integral id returned by the **MATCH** cypher query we executed above.

Create a country (You can choose any country name)
```
CREATE (c:Country{name:"Kenya"}) RETURN c
```

Create a timezone (You can choose any time-zone)
```
CREATE (t:Timezone{tz:"GMT+3"}) RETURN t
```

Both queries above should return nodes that should appear as circles on your Neo4j browsers. 

Create a user bio (you can enter any text in the quotation marks present in the description)
```
MATCH (u:User) WHERE id(u) = userID
MERGE (u) - [h:hasBio] -> (b:Bio{description:""}) RETURN u,h,b
```

Link John Smith, our create user, to the country and timezone we created:

```
MATCH (u:User) WHERE id(u) = userID MATCH (c:Country) WHERE id(c) = countryID MERGE (u) - [o:comesFROM] -> (c) RETURN u,o,c
```

```
MATCH (u:User) WHERE id(u) = 0 MATCH (tz:Timezone) WHERE id(tz) = timezoneID MERGE (u) - [f:followsTimeZone] -> (tz) RETURN u,f,tz
```

To get the countryID and timezoneID, you may press on the nodes that represent them and read their id values, which will be displayed at the bottom of that active window.

Next, create the user's interests - You can replace the the value of the tech skill name ("Go") with other values and run the query multiple times to create multiple skills.
```
MATCH (u:User) WHERE id(u) = userID MERGE (u) - [i:isInterestedIn] -> (t:TechSkill{name:"Go"}) RETURN u,i,t
```

Next, create the user's hobbies - You can replace the the value of the tech hobby name ("Cycling") with other values and run the query multiple times to create multiple hobbies.
```
MATCH (u:User) WHERE id(u) = userID MERGE (u) - [h:hasHobbie] -> (ho:Hobbie{name:"Cycling"}) RETURN u,h,ho
```

Create a user's dislike
```
MATCH (u:User) WHERE id(u) = userID MERGE (u) - [di:dislikes] -> (d:Dislike{description:"Going to Uni"}) RETURN u, di, d
```

To get a glimpse of how your graph looks like now, run the following:
```
MATCH (n) RETURN n
```
You should expect to see a graph, with nodes connected to a central node (the user).

**Congratulations**.Let's proceed to how you'll link it to Django.

In Django, navigate to the _views.py_ under the fship_app folder. At the top, you will see the following line of code:
```
driver = GraphDatabase.driver("neo4j://localhost:7687", auth=("user", "password"))
```
If you are using a Desktop instance of Neo4J:
All you have to do is replace the _user_ and _password_ fields with the username and password you used when creating the database. However, if you also changed the port, feel free to replace 7687 with your target port.

If you are using Neo4J Snadbox:
You have to replace the entire _neo4j://localhost:7687_ with the URL provided to you on the sandbox. Furthermore, replace the _user_ and _password_ fields with the username and password you used when creating the database.

You can now navigate to _urls.py_ file and use the routes to test the data you added to you Neo4J instance. 


